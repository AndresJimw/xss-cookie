{% extends "base.html" %}

{% block content %}
<section class="page-header">
    <div>
        <h1 class="page-title">Contact form - Blind XSS</h1>
        <p class="page-subtitle">
            Messages sent here are not reflected back to the user. They are only rendered when an
            admin opens the messages panel, which is typical of blind XSS scenarios.
        </p>
    </div>
</section>

<section class="grid">
    <article class="card">
        <div class="card-header">
            <h2 class="card-title">Send a message to the admin</h2>
        </div>

        {% if sent %}
            <div class="alert alert-success">
                Your message has been stored and will be displayed in the admin panel.
            </div>
            <p class="muted">
                As an attacker you cannot see the result here. Any payload you injected will only
                execute (if successful) when the admin opens <strong>Admin Messages</strong>.
            </p>
        {% else %}
            <form method="post" action="{{ url_for('main.contact') }}" class="form">
                <label for="message" class="form-label">Message</label>
                <textarea
                    id="message"
                    name="message"
                    rows="5"
                    class="form-textarea"
                    placeholder="Write a normal message, then test with XSS payloads that target the admin..."
                ></textarea>
                <button type="submit" class="btn btn-primary">Send message</button>
            </form>
        {% endif %}
    </article>
</section>
{% endblock %}
